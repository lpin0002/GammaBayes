data folder already exists (good)
Stem Folder Already Exists (good)
[ 3.76696723  3.68823851  3.60970756  3.53197192  3.44768024  3.37094894
  3.28783695  3.20500756  3.12318406  3.03406401  2.95358362  2.86605472
  2.77883713  2.6927802   2.59861414  2.51356315  2.42060043  2.32796529
  2.2366762   2.13620859  2.04656433  1.94808549  1.84999784  1.75352848
  1.64674931  1.55238536  1.4481802   1.34459772  1.2431627   1.13026491
  1.02991214  0.91835378  0.80713409  0.69801289  0.57550894  0.46869599
  0.34909454  0.2298559   0.11316394 -0.01896635 -0.13277695 -0.26122394
 -0.38931461 -0.51433479 -0.65724873 -0.77977453 -0.91943705 -1.05842093
 -1.19306904 -1.34871063 -1.47863708 -1.62800125 -1.77635629 -1.91906122
 -2.08557558 -2.22106317 -2.37782813 -2.53248725 -2.67914619 -2.85107267
 -2.98425839 -3.13794836 -3.28530841 -3.41888134 -3.57308747 -3.68493767
 -3.81089238 -3.92681358 -4.02672889 -4.13774676 -4.20195228 -4.27056477
 -4.32156806 -4.35193998 -4.3832633  -4.383124   -4.38298472 -4.53595491
 -4.93754239 -5.61914645 -6.09882471 -7.05477716        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf        -inf
        -inf        -inf        -inf        -inf        -inf]
Proposal:  [ 1.49366619  1.44761447  1.40156275  1.35551106  1.30945937  1.26340769
  1.21735601  1.17130431  1.12525261  1.0792009   1.0331492   0.98709748
  0.94104577  0.89499405  0.84894232  0.80289063  0.75683895  0.71078726
  0.66473553  0.61868383  0.57263214  0.52658044  0.48052877  0.43447706
  0.38842533  0.34237362  0.29632193  0.25027025  0.20421856  0.15816686
  0.11211512  0.0660634   0.02001173 -0.02603996 -0.07209167 -0.11814338
 -0.16419506 -0.21024675 -0.25629848 -0.30235019 -0.34840191 -0.39445361
 -0.44050528 -0.48655699 -0.53260871 -0.5786604  -0.6247121  -0.67076382
 -0.71681552 -0.76286723 -0.80891892 -0.85497059 -0.90102231 -0.94707403
 -0.99312573 -1.03917741 -1.0852291  -1.13128084 -1.17733254 -1.22338423
 -1.26943593 -1.31548762 -1.36153932 -1.40759103 -1.45364276 -1.49969446
 -1.54574612 -1.59179781 -1.63784954 -1.68390125 -1.72995293 -1.77600465
 -1.82205638 -1.86810809 -1.91415979 -1.96021148 -2.00626315 -2.05231483
 -2.09836654 -2.14441826 -2.19046998 -2.23652167 -2.28257338 -2.32862509
 -2.37467681 -2.42072849 -2.46678019 -2.51283189 -2.55888356 -2.60493528
 -2.650987   -2.6970387  -2.7430904  -2.7891421  -2.83519379 -2.88124549
 -2.92729719 -2.97334888 -3.01940058 -3.06545227 -3.11150401 -3.15755572
 -3.20360742 -3.24965911 -3.2957108  -3.34176254 -3.38781424 -3.43386593
 -3.47991764 -3.52596932 -3.57202101 -3.61807273 -3.66412445 -3.71017618
 -3.75622785 -3.80227955 -3.84833125 -3.89438293 -3.94043461 -3.98648632
 -4.03253802 -4.07858975 -4.12464147 -4.17069315 -4.21674484 -4.26279655
 -4.30884825 -4.35489993 -4.40095163 -4.44700336 -4.49305507 -4.53910676
 -4.58515848 -4.63121017 -4.67726185 -4.72331355 -4.76936527 -4.81541699
 -4.86146868 -4.90752039 -4.9535721  -4.99962379 -5.04567549 -5.09172717
 -5.13777886 -5.18383058 -5.2298823  -5.275934   -5.32198571 -5.3680374
 -5.41408909 -5.46014079 -5.50619248 -5.5522442  -5.59829592 -5.64434759
 -5.69039929 -5.73645102 -5.78250271 -5.82855437 -5.8746061  -5.92065784
 -5.96670955 -6.01276125 -6.05881296 -6.10486465 -6.15091636 -6.19696806
 -6.24301973 -6.28907143 -6.33512315 -6.38117483 -6.42722652 -6.47327824
 -6.51932995 -6.56538165 -6.61143335 -6.65748504 -6.70353675 -6.74958843
 -6.79564014 -6.84169186 -6.88774355 -6.93379525 -6.97984696 -7.02589865
 -7.07195035 -7.11800204 -7.16405373 -7.21010545 -7.25615717 -7.30220887
 -7.34826059 -7.39431231 -7.44036402 -7.48641569 -7.53246737 -7.57851908
 -7.6245708  -7.6706225  -7.71667417 -7.76272588 -7.80877759 -7.85482931
 -7.900881   -7.94693269 -7.99298439 -8.0390361  -8.08508782]
Creating measured signal vals:   0%|                                        | 0/200 [00:00<?, ?it/s]Creating measured signal vals:  26%|███████▋                      | 51/200 [00:00<00:00, 509.88it/s]Creating measured signal vals:  52%|██████████████▉              | 103/200 [00:00<00:00, 514.30it/s]Creating measured signal vals:  80%|███████████████████████▏     | 160/200 [00:00<00:00, 535.66it/s]Creating measured signal vals: 100%|█████████████████████████████| 200/200 [00:00<00:00, 528.38it/s]
Creating measured background vals: 0it [00:00, ?it/s]Creating measured background vals: 0it [00:00, ?it/s]
/fred/oz233/lpinchbe/DMPipe/utils.py:29: RuntimeWarning: divide by zero encountered in log
  val = np.log(edispkernel.evaluate(energy_true=np.power(10.,logetrue)*u.TeV, energy = np.power(10.,logerecon)*u.TeV).value)
/fred/oz233/lpinchbe/DMPipe/utils.py:30: RuntimeWarning: divide by zero encountered in log
  norm = special.logsumexp(np.log(edispkernel.evaluate(energy_true=np.power(10.,logetrue)*u.TeV, energy = np.power(10.,log10eaxis)*u.TeV).value)+logjacob)
Done simulation.
There are 200 events being analyzed.
Calculating edisp vals: 0it [00:00, ?it/s]Calculating edisp vals: 58it [00:00, 579.45it/s]Calculating edisp vals: 116it [00:00, 573.18it/s]Calculating edisp vals: 174it [00:00, 575.65it/s]Calculating edisp vals: 200it [00:00, 575.31it/s]
Calculating background marginalisations:   0%|                              | 0/200 [00:00<?, ?it/s]Calculating background marginalisations:   0%|                    | 1/200 [00:31<1:45:32, 31.82s/it]Calculating background marginalisations:   1%|▏                   | 2/200 [00:49<1:17:23, 23.45s/it]Calculating background marginalisations:   6%|█▏                   | 11/200 [01:00<11:54,  3.78s/it]Calculating background marginalisations:   6%|█▎                   | 12/200 [01:17<16:57,  5.41s/it]Calculating background marginalisations:   8%|█▋                   | 16/200 [01:50<20:13,  6.59s/it]Calculating background marginalisations:  12%|██▌                  | 24/200 [02:00<10:53,  3.71s/it]Calculating background marginalisations:  14%|███                  | 29/200 [02:06<08:22,  2.94s/it]Calculating background marginalisations:  16%|███▎                 | 32/200 [02:57<16:48,  6.00s/it]Calculating background marginalisations:  22%|████▌                | 43/200 [03:37<12:17,  4.70s/it]Calculating background marginalisations:  26%|█████▎               | 51/200 [03:40<07:54,  3.19s/it]Calculating background marginalisations:  26%|█████▍               | 52/200 [03:43<07:44,  3.14s/it]Calculating background marginalisations:  27%|█████▋               | 54/200 [03:49<07:40,  3.15s/it]Calculating background marginalisations:  28%|█████▊               | 55/200 [04:03<10:08,  4.19s/it]Calculating background marginalisations:  28%|█████▉               | 56/200 [04:11<11:02,  4.60s/it]Calculating background marginalisations:  30%|██████▏              | 59/200 [04:16<08:25,  3.58s/it]Calculating background marginalisations:  30%|██████▎              | 60/200 [04:26<10:37,  4.56s/it]Calculating background marginalisations:  31%|██████▌              | 62/200 [04:28<08:07,  3.53s/it]Calculating background marginalisations:  32%|██████▊              | 65/200 [04:30<05:21,  2.38s/it]Calculating background marginalisations:  33%|██████▉              | 66/200 [05:13<19:10,  8.59s/it]Calculating background marginalisations:  34%|███████▏             | 68/200 [05:21<15:56,  7.24s/it]Calculating background marginalisations:  38%|███████▉             | 76/200 [05:25<06:10,  2.99s/it]Calculating background marginalisations:  39%|████████▏            | 78/200 [05:35<06:49,  3.36s/it]Calculating background marginalisations:  40%|████████▍            | 80/200 [05:48<07:55,  3.96s/it]Calculating background marginalisations:  40%|████████▌            | 81/200 [05:55<08:48,  4.44s/it]Calculating background marginalisations:  43%|█████████            | 86/200 [06:04<05:52,  3.09s/it]Calculating background marginalisations:  44%|█████████▏           | 87/200 [06:10<06:32,  3.48s/it]Calculating background marginalisations:  44%|█████████▏           | 88/200 [06:18<07:47,  4.17s/it]Calculating background marginalisations:  45%|█████████▍           | 90/200 [06:32<09:15,  5.05s/it]Calculating background marginalisations:  46%|█████████▋           | 92/200 [06:41<08:45,  4.87s/it]Calculating background marginalisations:  48%|██████████▏          | 97/200 [06:53<06:03,  3.53s/it]Calculating background marginalisations:  50%|██████████          | 100/200 [07:00<05:19,  3.19s/it]Calculating background marginalisations:  50%|██████████          | 101/200 [07:00<04:43,  2.86s/it]Calculating background marginalisations:  51%|██████████▏         | 102/200 [07:51<16:36, 10.17s/it]Calculating background marginalisations:  55%|███████████         | 110/200 [08:16<08:29,  5.66s/it]Calculating background marginalisations:  58%|███████████▌        | 116/200 [08:45<07:30,  5.36s/it]Calculating background marginalisations:  62%|████████████▎       | 123/200 [08:52<04:38,  3.62s/it]Calculating background marginalisations:  62%|████████████▍       | 124/200 [08:56<04:32,  3.59s/it]Calculating background marginalisations:  62%|████████████▌       | 125/200 [08:58<04:20,  3.47s/it]Calculating background marginalisations:  64%|████████████▊       | 128/200 [09:03<03:29,  2.91s/it]Calculating background marginalisations:  65%|█████████████       | 130/200 [09:05<02:58,  2.55s/it]Calculating background marginalisations:  66%|█████████████       | 131/200 [09:18<04:27,  3.87s/it]Calculating background marginalisations:  66%|█████████████▏      | 132/200 [09:32<06:20,  5.60s/it]Calculating background marginalisations:  68%|█████████████▌      | 135/200 [09:34<03:54,  3.61s/it]Calculating background marginalisations:  68%|█████████████▌      | 136/200 [09:46<05:17,  4.96s/it]Calculating background marginalisations:  70%|█████████████▉      | 139/200 [09:50<03:27,  3.41s/it]Calculating background marginalisations:  70%|██████████████      | 140/200 [09:55<03:39,  3.65s/it]Calculating background marginalisations:  70%|██████████████      | 141/200 [09:58<03:33,  3.62s/it]Calculating background marginalisations:  71%|██████████████▏     | 142/200 [10:00<03:11,  3.29s/it]Calculating background marginalisations:  72%|██████████████▎     | 143/200 [10:01<02:34,  2.70s/it]Calculating background marginalisations:  72%|██████████████▍     | 144/200 [10:17<05:36,  6.01s/it]Calculating background marginalisations:  74%|██████████████▋     | 147/200 [10:32<04:48,  5.44s/it]Calculating background marginalisations:  74%|██████████████▊     | 148/200 [10:59<08:26,  9.74s/it]Calculating background marginalisations:  76%|███████████████▏    | 152/200 [11:12<05:02,  6.31s/it]Calculating background marginalisations:  78%|███████████████▋    | 157/200 [11:19<02:49,  3.94s/it]Calculating background marginalisations:  80%|████████████████    | 161/200 [11:52<03:34,  5.50s/it]Calculating background marginalisations:  82%|████████████████▍   | 164/200 [12:08<03:16,  5.46s/it]Calculating background marginalisations:  84%|████████████████▊   | 168/200 [12:21<02:29,  4.67s/it]Calculating background marginalisations:  85%|█████████████████   | 170/200 [12:27<02:09,  4.32s/it]Calculating background marginalisations:  87%|█████████████████▍  | 174/200 [12:57<02:21,  5.45s/it]Calculating background marginalisations:  92%|██████████████████▍ | 184/200 [13:08<00:48,  3.04s/it]Calculating background marginalisations:  92%|██████████████████▌ | 185/200 [13:33<01:09,  4.63s/it]Calculating background marginalisations:  94%|██████████████████▉ | 189/200 [14:02<00:59,  5.43s/it]Calculating background marginalisations:  96%|███████████████████▎| 193/200 [14:09<00:30,  4.36s/it]Calculating background marginalisations:  99%|███████████████████▊| 198/200 [14:14<00:06,  3.13s/it]Calculating background marginalisations: 100%|████████████████████| 200/200 [14:14<00:00,  4.27s/it]
Done calculating the background marginalisations
Calculating proposal marginalisations:   0%|                                | 0/200 [00:00<?, ?it/s]Calculating proposal marginalisations:   0%|                      | 1/200 [00:19<1:04:33, 19.47s/it]Calculating proposal marginalisations:   2%|▎                       | 3/200 [00:21<19:37,  5.98s/it]Calculating proposal marginalisations:   4%|▉                       | 8/200 [00:23<05:49,  1.82s/it]Calculating proposal marginalisations:   6%|█▎                     | 11/200 [00:37<09:18,  2.95s/it]Calculating proposal marginalisations:   6%|█▍                     | 12/200 [00:40<09:18,  2.97s/it]Calculating proposal marginalisations:   6%|█▍                     | 13/200 [00:41<08:06,  2.60s/it]Calculating proposal marginalisations:   7%|█▌                     | 14/200 [00:42<06:49,  2.20s/it]Calculating proposal marginalisations:   8%|█▊                     | 16/200 [00:49<08:17,  2.70s/it]Calculating proposal marginalisations:  10%|██▍                    | 21/200 [00:58<06:28,  2.17s/it]Calculating proposal marginalisations:  11%|██▌                    | 22/200 [01:00<06:33,  2.21s/it]Calculating proposal marginalisations:  12%|██▊                    | 24/200 [01:04<06:15,  2.13s/it]Calculating proposal marginalisations:  13%|██▉                    | 26/200 [01:20<11:06,  3.83s/it]Calculating proposal marginalisations:  15%|███▍                   | 30/200 [01:24<07:05,  2.51s/it]Calculating proposal marginalisations:  18%|████▎                  | 37/200 [01:26<03:41,  1.36s/it]Calculating proposal marginalisations:  19%|████▎                  | 38/200 [01:27<03:26,  1.28s/it]Calculating proposal marginalisations:  20%|████▍                  | 39/200 [01:42<08:12,  3.06s/it]Calculating proposal marginalisations:  20%|████▋                  | 41/200 [01:42<06:02,  2.28s/it]Calculating proposal marginalisations:  22%|████▉                  | 43/200 [01:48<06:26,  2.46s/it]Calculating proposal marginalisations:  24%|█████▍                 | 47/200 [02:02<07:19,  2.87s/it]Calculating proposal marginalisations:  24%|█████▌                 | 48/200 [02:03<06:39,  2.63s/it]Calculating proposal marginalisations:  25%|█████▊                 | 50/200 [02:05<05:18,  2.13s/it]Calculating proposal marginalisations:  28%|██████▍                | 56/200 [02:06<02:41,  1.12s/it]Calculating proposal marginalisations:  28%|██████▌                | 57/200 [02:20<06:09,  2.59s/it]Calculating proposal marginalisations:  29%|██████▋                | 58/200 [02:23<06:00,  2.54s/it]Calculating proposal marginalisations:  30%|██████▊                | 59/200 [02:24<05:33,  2.37s/it]Calculating proposal marginalisations:  31%|███████▏               | 62/200 [02:24<03:14,  1.41s/it]Calculating proposal marginalisations:  32%|███████▏               | 63/200 [02:26<03:10,  1.39s/it]Calculating proposal marginalisations:  33%|███████▌               | 66/200 [02:34<04:25,  1.98s/it]Calculating proposal marginalisations:  34%|███████▋               | 67/200 [02:40<05:50,  2.64s/it]Calculating proposal marginalisations:  34%|███████▊               | 68/200 [02:47<07:32,  3.43s/it]Calculating proposal marginalisations:  35%|████████               | 70/200 [02:47<05:00,  2.31s/it]Calculating proposal marginalisations:  36%|████████▍              | 73/200 [02:48<03:04,  1.45s/it]Calculating proposal marginalisations:  38%|████████▋              | 76/200 [02:56<04:00,  1.94s/it]Calculating proposal marginalisations:  38%|████████▊              | 77/200 [03:02<04:59,  2.44s/it]Calculating proposal marginalisations:  39%|████████▉              | 78/200 [03:04<04:55,  2.42s/it]Calculating proposal marginalisations:  40%|█████████              | 79/200 [03:04<04:00,  1.99s/it]Calculating proposal marginalisations:  40%|█████████▎             | 81/200 [03:08<04:02,  2.04s/it]Calculating proposal marginalisations:  42%|█████████▊             | 85/200 [03:10<02:14,  1.17s/it]Calculating proposal marginalisations:  43%|█████████▉             | 86/200 [03:17<03:50,  2.03s/it]Calculating proposal marginalisations:  44%|██████████             | 87/200 [03:24<05:43,  3.04s/it]Calculating proposal marginalisations:  44%|██████████▏            | 89/200 [03:28<04:53,  2.65s/it]Calculating proposal marginalisations:  46%|██████████▋            | 93/200 [03:29<02:36,  1.47s/it]Calculating proposal marginalisations:  47%|██████████▊            | 94/200 [03:31<02:42,  1.53s/it]Calculating proposal marginalisations:  48%|███████████            | 96/200 [03:38<03:44,  2.16s/it]Calculating proposal marginalisations:  48%|███████████▏           | 97/200 [03:42<04:19,  2.52s/it]Calculating proposal marginalisations:  49%|███████████▎           | 98/200 [03:46<04:37,  2.72s/it]Calculating proposal marginalisations:  50%|███████████▍           | 99/200 [04:00<08:56,  5.31s/it]Calculating proposal marginalisations:  53%|███████████▋          | 106/200 [04:04<03:10,  2.02s/it]Calculating proposal marginalisations:  54%|███████████▉          | 108/200 [04:21<05:21,  3.50s/it]Calculating proposal marginalisations:  57%|████████████▋         | 115/200 [04:23<02:29,  1.75s/it]Calculating proposal marginalisations:  58%|████████████▊         | 116/200 [04:27<02:48,  2.00s/it]Calculating proposal marginalisations:  59%|████████████▉         | 118/200 [04:28<02:20,  1.71s/it]Calculating proposal marginalisations:  60%|█████████████▏        | 120/200 [04:35<02:44,  2.05s/it]Calculating proposal marginalisations:  61%|█████████████▍        | 122/200 [04:36<02:08,  1.65s/it]Calculating proposal marginalisations:  62%|█████████████▌        | 123/200 [04:40<02:42,  2.11s/it]Calculating proposal marginalisations:  62%|█████████████▋        | 124/200 [04:43<02:55,  2.31s/it]Calculating proposal marginalisations:  63%|█████████████▊        | 126/200 [04:47<02:37,  2.12s/it]Calculating proposal marginalisations:  64%|█████████████▉        | 127/200 [04:49<02:35,  2.14s/it]Calculating proposal marginalisations:  65%|██████████████▎       | 130/200 [04:55<02:19,  1.99s/it]Calculating proposal marginalisations:  66%|██████████████▋       | 133/200 [05:02<02:26,  2.18s/it]Calculating proposal marginalisations:  67%|██████████████▋       | 134/200 [05:05<02:31,  2.30s/it]Calculating proposal marginalisations:  68%|██████████████▊       | 135/200 [05:05<02:05,  1.94s/it]Calculating proposal marginalisations:  69%|███████████████▏      | 138/200 [05:10<01:47,  1.73s/it]Calculating proposal marginalisations:  70%|███████████████▍      | 140/200 [05:14<01:50,  1.83s/it]Calculating proposal marginalisations:  72%|███████████████▋      | 143/200 [05:22<02:00,  2.12s/it]Calculating proposal marginalisations:  72%|███████████████▊      | 144/200 [05:24<01:57,  2.10s/it]Calculating proposal marginalisations:  72%|███████████████▉      | 145/200 [05:27<02:07,  2.31s/it]Calculating proposal marginalisations:  74%|████████████████▎     | 148/200 [05:39<02:40,  3.09s/it]Calculating proposal marginalisations:  75%|████████████████▌     | 150/200 [05:47<02:50,  3.42s/it]Calculating proposal marginalisations:  78%|█████████████████▎    | 157/200 [05:51<01:11,  1.66s/it]Calculating proposal marginalisations:  80%|█████████████████▍    | 159/200 [06:00<01:31,  2.24s/it]Calculating proposal marginalisations:  80%|█████████████████▌    | 160/200 [06:15<02:31,  3.79s/it]Calculating proposal marginalisations:  84%|██████████████████▍   | 168/200 [06:19<01:00,  1.88s/it]Calculating proposal marginalisations:  85%|██████████████████▋   | 170/200 [06:27<01:07,  2.26s/it]Calculating proposal marginalisations:  86%|██████████████████▉   | 172/200 [06:30<00:59,  2.12s/it]Calculating proposal marginalisations:  87%|███████████████████▏  | 174/200 [06:37<01:02,  2.42s/it]Calculating proposal marginalisations:  88%|███████████████████▍  | 177/200 [06:39<00:40,  1.78s/it]Calculating proposal marginalisations:  90%|███████████████████▋  | 179/200 [06:41<00:33,  1.60s/it]Calculating proposal marginalisations:  90%|███████████████████▊  | 180/200 [06:46<00:42,  2.10s/it]Calculating proposal marginalisations:  90%|███████████████████▉  | 181/200 [06:49<00:45,  2.39s/it]Calculating proposal marginalisations:  91%|████████████████████  | 182/200 [06:51<00:41,  2.32s/it]Calculating proposal marginalisations:  92%|████████████████████▎ | 185/200 [06:52<00:19,  1.32s/it]Calculating proposal marginalisations:  93%|████████████████████▍ | 186/200 [06:59<00:32,  2.35s/it]Calculating proposal marginalisations:  94%|████████████████████▋ | 188/200 [07:13<00:47,  3.99s/it]Calculating proposal marginalisations:  96%|█████████████████████ | 192/200 [07:26<00:28,  3.55s/it]Calculating proposal marginalisations:  97%|█████████████████████▎| 194/200 [07:28<00:17,  2.88s/it]Calculating proposal marginalisations: 100%|██████████████████████| 200/200 [07:31<00:00,  1.62s/it]Calculating proposal marginalisations: 100%|██████████████████████| 200/200 [07:31<00:00,  2.26s/it]
Done calculating the proposal marginalisations.
